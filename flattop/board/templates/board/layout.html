

<!doctype html>

<head>
    {% load static %}
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="{% static 'board/layoutStyle.css' %}">
    <title>FlatTop — Board</title>
</head>

<body>
    <header class="top">
        <div class="left">
            <h1>Lobby Name: NAME</h1>

            <div class="menubtn-row">
                <div class="file dropdown">
                    <button class="menubtn">File</button>
                    <div class="dropdown-content">
                        <a href="#">first</a>
                        <a href="#">second</a>
                        <a href="#">third</a>
                        <a href="#">4th</a>
                    </div>
                </div>

                <div class="file dropdown">
                    <button class="menubtn">Lobby</button>
                    <div class="dropdown-content">
                        <a href="#">first</a>
                        <a href="#">second</a>
                        <a href="#">third</a>
                        <a href="#">4th</a>
                    </div>
                </div>

                <div class="file dropdown">
                    <button class="menubtn">Insert</button>
                    <div class="dropdown-content">
                        <a href="#">first</a>
                        <a href="#">second</a>
                        <a href="#">third</a>
                        <a href="#">4th</a>
                    </div>
                </div>

                <div class="file dropdown">
                    <button class="menubtn">View</button>
                    <div class="dropdown-content">
                        <a href="#">first</a>
                        <a href="#">second</a>
                        <a href="#">third</a>
                        <a href="#">4th</a>
                    </div>
                </div>

                <div class="file dropdown">
                    <button class="menubtn">Help</button>
                    <div class="dropdown-content">
                        <a href="#">first</a>
                        <a href="#">second</a>
                        <a href="#">third</a>
                        <a href="#">4th</a>
                    </div>
                </div>
            </div>
        </div>

        <div class="right">
            <div class="right-row">
                <h1>Lobby Code: 123456</h1>
                <button class="sharebtn">Share</button>
            </div>
        </div>
    </header>

    <aside class="sidebar">
        <h2>Widgets</h2>
        <div class="widget-list">
            <button>Dice</button>
            <button>Cards</button>
            <button>Tokens</button>
            <button>Boards</button>
            <button>Rules</button>
            <button>Favorites</button>
        </div>
    </aside>

    <main class="mainBoard">
        <div class="toolbar">
    <span class="badge">Pan: Middle-mouse drag</span>
    <span class="badge">Zoom: Mouse wheel</span>
    <span class="badge">Reset</span>
    <button id="resetBtn">Reset view</button>
    <span class="hint">Cell size: 40px (change in CSS var <code>--cell</code>)</span>
  </div>

  <div class="wrap" id="wrap">
    <div class="board" id="board"></div>
  </div>

  <script>
    // --- minimal pan & zoom controller ---
    const wrap  = document.getElementById('wrap');
    const board = document.getElementById('board');
    const resetBtn = document.getElementById('resetBtn');

    let scale = 1;     // zoom factor
    let panX  = 0;     // translation in px
    let panY  = 0;

    function applyTransform() {
      board.style.transform = `translate(${panX}px, ${panY}px) scale(${scale})`;
    }
    function resetView() {
      scale = 1; panX = 0; panY = 0; applyTransform();
    }
    resetBtn.addEventListener('click', resetView);
    applyTransform();

    // Mouse wheel zoom around cursor
    wrap.addEventListener('wheel', (e) => {
      e.preventDefault();
      const rect = board.getBoundingClientRect();
      // Cursor position relative to board’s current transform
      const cx = (e.clientX - rect.left) / scale;
      const cy = (e.clientY - rect.top)  / scale;

      const direction = Math.sign(e.deltaY);        // -1 up (zoom in), +1 down (zoom out)
      const factor = direction > 0 ? 0.9 : 1.1;     // zoom step
      const newScale = Math.min(3, Math.max(0.2, scale * factor));
      if (newScale === scale) return;

      // Keep cursor “anchored” by adjusting pan as we zoom
      panX = e.clientX - cx * newScale;
      panY = e.clientY - cy * newScale;
      scale = newScale;
      applyTransform();
    }, { passive: false });

    // Middle-mouse panning (button === 1)
    let panning = false;
    let startX = 0, startY = 0;
    let basePanX = 0, basePanY = 0;

    wrap.addEventListener('mousedown', (e) => {
      if (e.button !== 1) return;      // only middle button
      panning = true;
      startX = e.clientX;
      startY = e.clientY;
      basePanX = panX;
      basePanY = panY;
      e.preventDefault();
    });

    window.addEventListener('mousemove', (e) => {
      if (!panning) return;
      panX = basePanX + (e.clientX - startX);
      panY = basePanY + (e.clientY - startY);
      applyTransform();
    });

    window.addEventListener('mouseup', () => {
      panning = false;
    });

    // Optional: Spacebar to toggle temporary panning with left mouse
    // (handy trackpad mode—comment out if you don’t want it)
    let spacePan = false;
    window.addEventListener('keydown', (e) => { if (e.code === 'Space') spacePan = true; });
    window.addEventListener('keyup',   (e) => { if (e.code === 'Space') spacePan = false; });

    wrap.addEventListener('mousedown', (e) => {
      if (!(spacePan && e.button === 0)) return;  // left click with Space held
      panning = true;
      startX = e.clientX;
      startY = e.clientY;
      basePanX = panX;
      basePanY = panY;
      e.preventDefault();
    }, true);
  </script>
    </main>

</body>

</html>